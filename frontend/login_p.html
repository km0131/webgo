<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”»åƒãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢</title>
    <!-- Tailwind CSSã‚’èª­ã¿è¾¼ã¿ (Bootstrapã®ä»£ã‚ã‚Šã«è»½é‡ã§ãƒ¢ãƒ€ãƒ³ãªã‚¹ã‚¿ã‚¤ãƒ«ã‚’å®Ÿç¾) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#0d6efd',
                        'bg-light': '#f8f9fa',
                    },
                }
            }
        }
    </script>
    <style>
        /* ãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹ã‚³ãƒ³ãƒ†ãƒŠã‚¹ã‚¿ã‚¤ãƒ« */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem 0;
            background-color: #f8f9fa; /* èƒŒæ™¯è‰²ã‚’è–„ã„ã‚°ãƒ¬ãƒ¼ã«è¨­å®š */
        }

        /* ã‚«ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ« */
        .login-card {
            width: 100%;
            max-width: 420px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, .1); /* å½±ã‚’å¼·èª¿ */
            border-radius: 0.75rem; /* è§’ä¸¸ã‚’é©ç”¨ */
            background-color: white;
        }

        /* ç”»åƒé¸æŠã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .image-gallery {
            /* ä¿®æ­£ç‚¹: Flexboxã‹ã‚‰Gridã«å¤‰æ›´ã—ã€å¸¸ã«2åˆ—(1fr 1fr)ã§è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«è¨­å®š */
            display: grid;
            grid-template-columns: 1fr 1fr; /* 2ã¤ã®å‡ç­‰ãªåˆ—ã‚’ä½œæˆ */
            gap: 10px; /* ç”»åƒé–“ã®ã‚¹ãƒšãƒ¼ã‚¹ */
            margin-bottom: 1.5rem;
        }
        
        /* ç”»åƒã‚’ã‚®ãƒ£ãƒ©ãƒªãƒ¼å†…ã§ä¸­å¤®æƒãˆã«ã™ã‚‹ãŸã‚ã®ã‚³ãƒ³ãƒ†ãƒŠ */
        .image-choice-container {
            display: flex;
            justify-content: center; /* ç”»åƒã‚’ä¸­å¤®ã«é…ç½® */
        }

        /* 1. æ¨™æº–ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’éè¡¨ç¤ºã«ã™ã‚‹ */
        .image-checkbox {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        /* 2. ç”»åƒã®åˆæœŸã‚¹ã‚¿ã‚¤ãƒ« */
        .selectable-image {
            width: 150px; /* 2åˆ—è¡¨ç¤ºã«åˆã†ã‚ˆã†ã«å¹…ã‚’èª¿æ•´ */
            height: 150px; /* 2åˆ—è¡¨ç¤ºã«åˆã†ã‚ˆã†ã«é«˜ã•ã‚’èª¿æ•´ */
            object-fit: cover;
            cursor: pointer;
            border: 4px solid transparent; /* åˆæœŸçŠ¶æ…‹ã§ã¯é€æ˜ãªæ ç·š */
            border-radius: 8px; /* è§’ä¸¸ã‚’é©ç”¨ */
            transition: border-color 0.2s, box-shadow 0.2s, transform 0.1s;
        }
        
        /* ãƒ›ãƒãƒ¼æ™‚ã®è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ */
        .selectable-image:hover {
            transform: scale(1.02);
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.2);
        }

        /* 3. ç”»åƒãŒé¸æŠã•ã‚ŒãŸï¼ˆãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãŒãƒã‚§ãƒƒã‚¯ã•ã‚ŒãŸï¼‰æ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .image-checkbox:checked + label .selectable-image {
            border-color: #0d6efd; /* ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ–ãƒ«ãƒ¼ */
            box-shadow: 0 0 15px rgba(13, 110, 253, 0.7); /* å½±ã‚’ä»˜ã‘ã‚‹ */
            transform: scale(1.05);
        }
        
        /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ã®æœ€å°é«˜ã•ã‚’ç¢ºä¿ */
        #match_message {
            min-height: 1.5rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 1rem;
        }
    </style>
</head>

<body>
    <div class="login-container">
        <div class="login-card">
            <div>
                <h3 class="text-center text-2xl font-bold mb-8 text-primary-blue">ğŸ” ãƒ­ã‚°ã‚¤ãƒ³</h3>
                
                <form id="loginForm" action="#" method="POST">
                    <!-- ç”»åƒãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰é¸æŠ -->
                    <label class="block text-gray-700 font-semibold mb-3">
                        ğŸ” ç”»åƒãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ (3ã¤ã®ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„)
                    </label>
                    
                    <div id="image-gallery" class="image-gallery">
                        <!-- Goè¨€èªã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ§‹æ–‡ã«æˆ»ã—ã¾ã™ -->
                        {{range $index, $path := .img}}
                            <div class="image-choice-container">
                                <input type="checkbox" id="student-img-{{$index}}" name="selected_images[]"
                                    value="{{index $.img_name $index}}" class="image-checkbox">
                                <label for="student-img-{{$index}}">
                                    <img src="{{$path}}" data-id="{{index $.img_name $index}}"
                                        class="selectable-image" alt="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç”»åƒ">
                                </label>
                            </div>
                        {{end}}
                    </div>
                    
                    <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
                    <p id="match_message" class="text-center font-semibold text-gray-500 mb-6">é¸æŠä¸­ã®ç”»åƒ: 0/3æš</p>

                    <!-- ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ -->
                    <div class="d-grid mb-6">
                        <button type="submit" class="w-full bg-primary-blue hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition duration-150" id="loginSubmitBtn">
                            ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹
                        </button>
                    </div>
                </form>
                
                <hr class="my-6 border-gray-300">

                <!-- é–¢é€£ãƒªãƒ³ã‚¯ -->
                <div class="text-center">
                    <a href="/" class="block text-sm text-primary-blue hover:text-blue-700 font-semibold transition duration-150">
                        ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            /**
             * ç”»åƒé¸æŠãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡ã‚’æ¤œè¨¼ã—ã€3æšé¸æŠã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹é–¢æ•°
             * @param {string} formSelector - å¯¾è±¡ãƒ•ã‚©ãƒ¼ãƒ ã®CSSã‚»ãƒ¬ã‚¯ã‚¿
             * @param {string} messageSelector - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹è¦ç´ ã®CSSã‚»ãƒ¬ã‚¯ã‚¿
             */
            function validateImageSelection(formSelector, messageSelector) {
                const form = document.querySelector(formSelector);
                const messageElement = document.querySelector(messageSelector);

                if (!form || !messageElement) return;

                form.addEventListener('submit', function (event) {
                    // ãƒ•ã‚©ãƒ¼ãƒ å†…ã®ãƒã‚§ãƒƒã‚¯ã•ã‚ŒãŸãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’å–å¾—
                    const selectedImages = form.querySelectorAll('.image-checkbox:checked');

                    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®é€ä¿¡ã‚’ä¸€æ—¦åœæ­¢
                    event.preventDefault();

                    messageElement.textContent = ''; // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢

                    if (selectedImages.length < 3) {
                        messageElement.textContent = 'é¸æŠã•ã‚ŒãŸç”»åƒãŒå°‘ãªã™ãã¾ã™ã€‚(3ã¤é¸æŠã—ã¦ãã ã•ã„)';
                        messageElement.style.color = 'red';
                    } else if (selectedImages.length > 3) {
                        // ã“ã®ãƒ«ãƒ¼ãƒˆã¯changeãƒªã‚¹ãƒŠãƒ¼ã§ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã¯ãšã ãŒã€å¿µã®ãŸã‚
                        messageElement.textContent = 'é¸æŠã•ã‚ŒãŸç”»åƒãŒå¤šã™ãã¾ã™ã€‚(3ã¤é¸æŠã—ã¦ãã ã•ã„)';
                        messageElement.style.color = 'red';
                    } else {
                        // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ
                        messageElement.textContent = 'ç”»åƒã‚’3æšé¸æŠã—ã¾ã—ãŸã€‚ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™...';
                        messageElement.style.color = 'green';
                        form.submit();
                    }
                });

                // é¸æŠæšæ•°ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒã‚§ãƒƒã‚¯ã—ã€æœ€å¤§3æšã«åˆ¶é™ã™ã‚‹ãƒªã‚¹ãƒŠãƒ¼
                const checkboxes = form.querySelectorAll('.image-checkbox');
                checkboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', () => {
                        const count = form.querySelectorAll('.image-checkbox:checked').length;
                        
                        if (count > 3) {
                            // 4æšç›®ä»¥é™ã®é¸æŠã‚’ãƒ–ãƒ­ãƒƒã‚¯
                            checkbox.checked = false;
                            messageElement.textContent = 'é¸æŠã§ãã‚‹ç”»åƒã¯æœ€å¤§3æšã¾ã§ã§ã™ã€‚';
                            messageElement.style.color = 'red';
                        } else if (count === 3) {
                            messageElement.textContent = 'ç”»åƒãŒ3ã¤é¸æŠã•ã‚Œã¾ã—ãŸã€‚ãƒ­ã‚°ã‚¤ãƒ³å¯èƒ½ã§ã™ã€‚';
                            messageElement.style.color = 'green';
                        } else {
                            messageElement.textContent = `é¸æŠä¸­ã®ç”»åƒ: ${count}/3æš`;
                            messageElement.style.color = 'gray';
                        }
                    });
                });
            }

            // ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
            validateImageSelection('#loginForm', '#match_message');
        });
    </script>
</body>
</html>